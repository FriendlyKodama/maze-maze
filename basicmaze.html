<!-- Standalone basic maze using HTML Canvas-->

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>maze maze</title>
    <script type="text/javascript">
      const TILE_SIZE = 15;
      const TOP_MARGIN = 2 * TILE_SIZE;
      const MAZE_ROWS = 28;
      const MAZE_COLS = 50;
      let start = [Math.floor(cheesyRandom(window.performance.now())*MAZE_COLS-1), 0];
      let finish = [Math.floor(cheesyRandom(window.performance.now())*MAZE_COLS-1), MAZE_ROWS-1];
      console.log(start);
      console.log(finish);

      // maze indexed [col,row] or [x,y]
      // top left cell is [0,0]

      // initially all walls are filled in
      var horizWalls = new Array(MAZE_COLS);
      for (var i = 0; i < horizWalls.length; i++) {
        horizWalls[i] = new Array(MAZE_ROWS+1);
        for (var j = 0; j < MAZE_ROWS+1; j++) {
          horizWalls[i][j] = true;
        }
      }
      var vertWalls = new Array(MAZE_COLS+1);
      for (var i = 0; i < vertWalls.length; i++) {
        vertWalls[i] = new Array(MAZE_ROWS);
        for (var j = 0; j < MAZE_ROWS; j++) {
          vertWalls[i][j] = true;
        }
      }

      function makeAndDraw() {
        draw();
      }

      function downArrow(x,y) {
        let p = new Path2D('M ' + x + ' ' + y + ' h 4 v 8 h 4 l -6 6 l -6 -6 h 4 Z');
        return p;  
      }
      
      function draw() {

        var canvas = document.getElementById('mazeFrame');
        var canvasWidth = canvas.width;
        var canvasHeight = canvas.height;
        if (canvas.getContext) {
          var ctx = canvas.getContext('2d');
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          let startArrow = downArrow(start[0] * TILE_SIZE, TILE_SIZE);
          ctx.fill(startArrow);
          let finishArrow = downArrow(finish[0] * TILE_SIZE, TOP_MARGIN + MAZE_ROWS * TILE_SIZE);
          ctx.fill(finishArrow);
          // draw walls, vert and horiz
          for (var row = 0; row < MAZE_ROWS; row += 1) {
            for (var col = 0; col < MAZE_COLS; col += 1) {
              // set x,y to top left of cell [col][row]
              var x = col * TILE_SIZE;
              var y = TOP_MARGIN + row * TILE_SIZE;
              if (horizWalls[col][row]) {
                ctx.beginPath();
                ctx.strokeStyle = '#000000';
                ctx.moveTo(x + 1, y);
                ctx.lineTo(x + TILE_SIZE-2, y);
                ctx.stroke();
              }
              if (vertWalls[col][row]) {
                ctx.beginPath();
                ctx.strokeStyle = '#000000';
                ctx.moveTo(x, y + 1);
                ctx.lineTo(x, y + TILE_SIZE-2);
                ctx.stroke();
              }
              // if in last col, may need to draw extra vert at end of row
              if (col == MAZE_COLS-1) {
                if (vertWalls[col+1][row]) {
                  ctx.beginPath();
                  ctx.strokeStyle = '#000000';
                  ctx.moveTo(x + TILE_SIZE, y + 1);
                  ctx.lineTo(x + TILE_SIZE, y + TILE_SIZE-2);
                  ctx.stroke();
                }
              }
              // if in last row, may need to draw extra horiz at bottom of column
              if (row == MAZE_ROWS-1) {
                if (horizWalls[col][row+1]) {
                  ctx.beginPath();
                  ctx.strokeStyle = '#000000';
                  ctx.moveTo(x + 1, y + TILE_SIZE);
                  ctx.lineTo(x + TILE_SIZE-2, y + TILE_SIZE);
                  ctx.stroke();
                }
              }
            }
          }
        }
      }


      // low-budget 'random' generator
      // found this on Stack Overflow
      function cheesyRandom(seed) {
          var x = Math.sin(seed) * 1000000;
          return x - Math.floor(x);
      }


    </script>
    <style type="text/css">
      canvas { padding: 20px; }
      #main {
        background: #999;
        padding: 10px;
      }

      .frame {
        background: #ccc;
        /*height: 200px;*/
        margin: 20px;
      }
    </style>
  </head>


  <body onload="makeAndDraw();">
    <div id="main">
      <div class="frame">
        <canvas id="mazeFrame" width="800" height="490"></canvas>
      </div> 
    </div>
  </body>
</html>